<rl:UiPage
    x:Class="RevitLookup.Views.Pages.SnoopView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:rl="http://revitlookup.com/xaml"
    xmlns:pages="clr-namespace:RevitLookup.Views.Pages"
    xmlns:converters="clr-namespace:RevitLookup.Views.Converters"
    xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
    mc:Ignorable="d"
    d:DesignHeight="500"
    d:DesignWidth="500"
    d:DataContext="{d:DesignInstance pages:SnoopView, IsDesignTimeCreatable=False}">
    <rl:UiPage.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <rl:ThemesDictionary
                    Theme="Dark" />
                <rl:ControlsDictionary />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </rl:UiPage.Resources>
    <Grid>
        <Grid
            Visibility="{Binding ViewModel.SnoopableObjects,
                Converter={converters:CollectionEmptyVisibilityConverter}}">
            <Image
                VerticalAlignment="Center"
                HorizontalAlignment="Center"
                MaxHeight="300">
                <Image.Source>
                    <DrawingImage>
                        <DrawingImage.Drawing>
                            <GeometryDrawing
                                Geometry="M159.1 110.6C94.1 204.3 -147.8 214.7 -203.8 126.1C-259.8 37.5 -129.9 -150 -8.9 -155.2C112 -160.3 224 16.8 159.1 110.6">
                                <GeometryDrawing.Pen>
                                    <Pen
                                        Brush="{DynamicResource ControlFillColorDefaultBrush}"
                                        Thickness="1" />
                                </GeometryDrawing.Pen>
                            </GeometryDrawing>
                        </DrawingImage.Drawing>
                    </DrawingImage>
                </Image.Source>
            </Image>
            <StackPanel
                Margin="0 40 0 0"
                HorizontalAlignment="Center"
                VerticalAlignment="Center">
                <TextBlock
                    FontSize="24"
                    FontWeight="Medium"
                    Text="Nothing to show" />
                <Button
                    HorizontalAlignment="Center"
                    Margin="0 8 0 0"
                    Content="Snoop selection"
                    Command="{Binding ViewModel.SnoopSelectionCommand}" />
            </StackPanel>
        </Grid>
        <Grid
            Visibility="{Binding ViewModel.SnoopableObjects,
                Converter={converters:InverseCollectionSizeVisibilityConverter}}"
            Margin="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition
                    Width="*" />
                <ColumnDefinition
                    Width="10" />
                <ColumnDefinition
                    Width="2*" />
            </Grid.ColumnDefinitions>
            <TreeView
                Grid.Column="0"
                x:Name="TreeView"
                VirtualizingStackPanel.IsVirtualizing="True"
                VirtualizingStackPanel.VirtualizationMode="Recycling"
                ItemsSource="{Binding ViewModel.SnoopableObjects}">
                <TreeView.ItemTemplate>
                    <HierarchicalDataTemplate>
                        <TextBlock
                            Text="{Binding Descriptor.Label}" />
                    </HierarchicalDataTemplate>
                </TreeView.ItemTemplate>
                <i:Interaction.Triggers>
                    <i:EventTrigger
                        EventName="SelectedItemChanged">
                        <i:InvokeCommandAction
                            Command="{Binding ViewModel.RefreshCommand}"
                            CommandParameter="{Binding SelectedItem, ElementName=TreeView}" />
                    </i:EventTrigger>
                </i:Interaction.Triggers>
            </TreeView>
            <DataGrid
                Grid.Column="2"
                Margin="0 0 6 2"
                AutoGenerateColumns="False"
                GridLinesVisibility="All"
                IsReadOnly="True"
                HeadersVisibility="Column"
                HorizontalGridLinesBrush="{DynamicResource PaletteGreyBrush}"
                VerticalGridLinesBrush="{DynamicResource PaletteGreyBrush}"
                ColumnHeaderHeight="30"
                RowHeight="25"
                CanUserReorderColumns="False"
                CanUserResizeColumns="True"
                ItemsSource="{Binding ViewModel.SnoopableData}">
                <DataGrid.Columns>
                    <DataGridTextColumn
                        Width="2*"
                        Binding="{Binding Descriptor.Label}"
                        Header="Field">
                    </DataGridTextColumn>
                    <DataGridTextColumn
                        Width="*"
                        Binding="{Binding Descriptor.Label}"
                        Header="Value">
                    </DataGridTextColumn>
                </DataGrid.Columns>
            </DataGrid>
        </Grid>
    </Grid>
</rl:UiPage>